
# Exploras Agent - EPUB Knowledge Explorer 📚

![Version](https://img.shields.io/badge/version-v1.0.0-blue.svg)
![License](https://img.shields.io/badge/license-AGPLv3-green.svg)
![Platform](https://img.shields.io/badge/platform-Docker%20%7C%20Kubernetes-orange.svg)
![Status](https://img.shields.io/badge/status-Production%20Ready-brightgreen.svg)
![AI](https://img.shields.io/badge/AI-Powered-purple.svg)

**This repository is entirely generated by AI under human instructions.**

## 🚀 Current Release: v1.0.0

✨ **Latest Release**: Complete Kubernetes deployment with multi-environment support  
📅 **Release Date**: July 27, 2025  
🔗 **Release Notes**: [View full changelog](../../releases/tag/v1.0.0)

### What's New in v1.0.0
- ✅ **Multi-Environment Support**: Docker Compose (development) + Kubernetes (production)
- ✅ **Production-Ready Deployment**: Complete MicroK8s setup with ingress
- ✅ **Automated Scripts**: Cross-platform deployment automation
- ✅ **Comprehensive Documentation**: Setup guides for all environments
- ✅ **Cost-Optimized Architecture**: Selective EPUB content processing

✳️ An experimental AI-powered agent for extracting knowledge from EPUB books with **cost-optimized Q&A** through selective TOC-based content processing. The provided example uses *Cloud-Native Ecosystems*, but the solution is applicable to any EPUB with a Table of Contents (TOC).

## 🎯 Purpose
This is an experimental prototype to validate:
- **Cost Optimization**: Send only selected TOC sections to OpenAI instead of entire books
- **UX Workflow**: Interactive TOC selection → Targeted Q&A
- **Architecture**: FastAPI backend + Angular frontend with Material Design

## � Deployment Options

### 🐳 Docker Compose (Simple Development)

#### Prerequisites
- Docker Desktop installed
- Git (to clone the repository)

#### Option 1: PowerShell Script (Windows)
```powershell
./start.ps1
```

#### Option 2: Bash Script (Linux/Mac/WSL)
```bash
chmod +x start.sh
./start.sh
```

#### Option 3: Make Commands
```bash
make start        # Build and start all services
make status       # Check container status
make logs         # View logs
make down         # Stop services
make clean        # Complete cleanup
```

#### Option 4: Manual Docker Compose
```bash
# Build and start
docker-compose up --build -d

# Check status
docker-compose ps

# View logs
docker-compose logs -f

# Stop
docker-compose down
```

### ☸️ Kubernetes with MicroK8s (Production-Ready)

#### Prerequisites
- Ubuntu 24.04 (or WSL2 with Ubuntu)
- MicroK8s installed and configured

#### Setup MicroK8s
```bash
# Install MicroK8s
sudo snap install microk8s --classic

# Add user to microk8s group
sudo usermod -a -G microk8s $USER
sudo chown -f -R $USER ~/.kube
newgrp microk8s

# Enable required addons
microk8s enable registry storage ingress

# Verify installation
microk8s status
```

#### Build and Deploy
```bash
# Build backend image
sudo docker build -t localhost:32000/exploras-backend:latest backend/
sudo docker push localhost:32000/exploras-backend:latest

# Build frontend image
sudo docker build -t localhost:32000/exploras-frontend:latest frontend/
sudo docker push localhost:32000/exploras-frontend:latest

# Deploy to Kubernetes
microk8s kubectl apply -f k8s/backend.yaml
microk8s kubectl apply -f k8s/frontend.yaml
microk8s kubectl apply -f k8s/ingress.yaml

# Check deployment status
microk8s kubectl get pods
microk8s kubectl get services
microk8s kubectl get ingress
```

#### Access Application (Kubernetes)
```bash
# Option 1: Port-forward (temporary access)
microk8s kubectl port-forward service/exploras-frontend-service 8080:80

# Then visit http://localhost:8080

# Option 2: Ingress (permanent access)
# Add to /etc/hosts (Linux/Mac) or C:\Windows\System32\drivers\etc\hosts (Windows):
# 127.0.0.1 exploras.local
# Then visit http://exploras.local
```

## 🌐 Access the Application

### Docker Compose
After starting the containers:
- **Frontend**: http://localhost
- **Backend API**: http://localhost:8000
- **API Docs**: http://localhost:8000/docs

### Kubernetes (MicroK8s)
After deploying to Kubernetes:
- **Frontend**: http://localhost:8080 (via port-forward) or http://exploras.local (via ingress)
- **Backend API**: Accessible internally to frontend via `exploras-backend-service:8000`
- **API Docs**: http://exploras.local/api/docs (via frontend proxy)

## 🏗️ Architecture

### Docker Compose (Development)
```
┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │    Backend      │
│   Angular +     │◄──►│   FastAPI +     │
│   Material +    │    │   ebooklib +    │
│   Nginx         │    │   Python        │
│   Port: 80      │    │   Port: 8000    │
└─────────────────┘    └─────────────────┘
```

### Kubernetes (Production)
```
┌─────────────────────────┐
│      Ingress            │
│   (exploras.local)      │
└──────────┬──────────────┘
           │
┌──────────▼──────────────┐    ┌─────────────────────────┐
│   Frontend Service      │    │   Backend Service       │
│   (exploras-frontend-   │◄──►│   (exploras-backend-    │
│    service:80)          │    │    service:8000)        │
└──────────┬──────────────┘    └──────────┬──────────────┘
           │                              │
┌──────────▼──────────────┐    ┌──────────▼──────────────┐
│   Frontend Pod          │    │   Backend Pod           │
│   Angular + Nginx       │    │   FastAPI + Python      │
│   (Containerized)       │    │   (Containerized)       │
└─────────────────────────┘    └─────────────────────────┘
```

## 📁 Project Structure

```
exploras-agent/
├── backend/                 # FastAPI backend
│   ├── main.py             # Main API server
│   ├── requirements.txt    # Python dependencies
│   └── Dockerfile          # Backend container
├── frontend/               # Angular frontend
│   ├── src/                # Angular source code
│   ├── package.json        # Node dependencies
│   ├── Dockerfile          # Frontend container
│   └── nginx.conf          # Nginx configuration
├── k8s/                    # Kubernetes manifests
│   ├── backend.yaml        # Backend deployment & service
│   ├── frontend.yaml       # Frontend deployment & service
│   ├── ingress.yaml        # Ingress configuration
│   ├── configmap.yaml      # Configuration maps
│   ├── deploy.sh           # Deployment script
│   ├── cleanup.sh          # Cleanup script
│   └── Makefile           # Kubernetes commands
├── ebook/                  # EPUB files
├── samples/                # Utility scripts
├── plugin/                 # Integration plugins
├── docker-compose.yml      # Service orchestration
├── start.ps1              # Windows startup script
├── start.sh               # Linux/Mac startup script
└── Makefile               # Make commands
```

## 🔧 Development

### Local Development (without Docker)
```bash
# Backend
cd backend
pip install -r requirements.txt
python main.py

# Frontend (requires Node.js 18+)
cd frontend
npm install
ng serve
```

### Development with Docker
```bash
# Docker Compose development
make dev  # Auto-rebuild on changes

# Kubernetes development
cd k8s
make build-dev    # Build development images
make deploy-dev   # Deploy to MicroK8s
make logs         # View pod logs
```

### Troubleshooting

#### Docker Issues
```bash
# Check container logs
docker-compose logs backend
docker-compose logs frontend

# Rebuild containers
docker-compose up --build --force-recreate
```

#### Kubernetes Issues
```bash
# Check pod status
microk8s kubectl get pods -o wide

# Check pod logs
microk8s kubectl logs <pod-name>

# Check services
microk8s kubectl get services

# Debug pod connectivity
microk8s kubectl exec -it <frontend-pod> -- wget -q -O - http://exploras-backend-service:8000/health
```

## 🧪 Testing the API

### Docker Compose
```bash
# Get Table of Contents
curl http://localhost:8000/toc

# Ask a Question
curl -X POST -H "Content-Type: application/json" \
  -d '{"toc_id":"toc_0_0","question":"What is this chapter about?"}' \
  http://localhost:8000/question
```

### Kubernetes
```bash
# Port-forward to backend (for direct API testing)
microk8s kubectl port-forward service/exploras-backend-service 8001:8000

# Get Table of Contents
curl http://localhost:8001/toc

# Ask a Question
curl -X POST -H "Content-Type: application/json" \
  -d '{"toc_id":"toc_0_0","question":"What is this chapter about?"}' \
  http://localhost:8001/question

# Test via frontend proxy (when frontend is port-forwarded to 8080)
curl http://localhost:8080/api/toc
```

## 🎨 Features

- **Cost Optimization**: Selective content loading instead of entire books
- **Material Design**: Blue/orange Exploras theme
- **TOC Tree**: Interactive chapter/section selection
- **Q&A Interface**: Context-aware responses with metadata
- **Multi-Platform Deployment**: Docker Compose + Kubernetes support
- **Production Ready**: MicroK8s deployment with ingress and service mesh
- **API Documentation**: Auto-generated with FastAPI
- **Responsive UI**: Works on desktop and mobile
- **Container Orchestration**: Full Kubernetes manifests with deployments, services, and ingress

## 📝 Current Status

✅ **Working Features:**
- EPUB loading and TOC extraction
- FastAPI backend with /toc and /question endpoints
- Angular frontend with Material Design
- Docker containerization with Nginx proxy
- Kubernetes deployment on MicroK8s
- Service mesh with internal DNS resolution
- Ingress controller for external access
- Cost-optimized content selection

🔄 **In Progress:**
- OpenAI integration (currently using mock responses)
- Enhanced UI components
- Authentication system
- Monitoring and logging integration

## 🤝 How it Works

1. **Upload/Select**: User selects an EPUB file via the web UI
2. **TOC Extraction**: Backend parses the TOC structure
3. **Interactive Selection**: User selects specific chapters/sections
4. **Targeted Q&A**: Only selected content is sent to AI (cost optimization)
5. **Real-time Answers**: Responses displayed with context metadata

## � Release History

### v1.0.0 (July 27, 2025) - Production Ready 🚀
- **Multi-Environment Support**: Complete Docker Compose + Kubernetes deployment
- **Production Architecture**: MicroK8s with ingress, service mesh, container registry
- **Automated Deployment**: Cross-platform scripts for all environments
- **Comprehensive Documentation**: Complete setup guides and troubleshooting
- **Container Orchestration**: Full Kubernetes manifests and Docker optimization
- **Cost-Optimized AI**: Selective content processing architecture ready for OpenAI

### Upcoming Releases 🔮
- **v1.1.0**: OpenAI integration and real AI responses
- **v1.2.0**: Authentication system and user management
- **v2.0.0**: Multi-book support and advanced analytics

## �📄 License

Licensed under the [GNU AGPLv3](LICENSE).
Powered by **OldBirba**, AI Assistant of Gandalf ✨
